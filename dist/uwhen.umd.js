!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).uwhen={})}(this,(function(e){"use strict";var t=new Set;function n(e,n){var o=new Set;function i(){document.querySelectorAll(e).forEach((function(i){if(!o.has(i)){o.add(i);var c=n(i),u="function"==typeof c?c:function(){};!function(e,n,o){function i(){n&&document.contains(n)&&n.matches(e)||(t.delete(i),o())}setTimeout(i),t.add(i)}(e,i,(function(){o.delete(i),u()}))}}))}setTimeout(i),t.add(i)}new window.MutationObserver((function(){t.forEach((function(e){return e()}))})).observe(document,{attributes:!0,childList:!0,subtree:!0});var o="function"==typeof Promise?Promise:function(e){let t,n=[],o=0;return e((e=>{t=e,o=1,n.splice(0).forEach(i)})),{then:i};function i(e){return o?setTimeout(e,0,t):n.push(e),this}};const i=e=>{const{$:t,r:n,h:o}=e;f(n)&&(c.get(o).delete(e),n()),f(e.r=t())&&c.get(o).add(e)},c=new WeakMap,u=[],r=[],f=e=>"function"==typeof e,s=e=>{const t={h:n,c:null,a:null,e:0,i:0,s:[]};return n;function n(){t.e=t.i=0;try{return e.apply(t.c=this,t.a=arguments)}finally{u.length&&a.then(u.forEach.bind(u.splice(0),i)),r.length&&r.splice(0).forEach(i)}}},a=new o((e=>e()));e.when=(e,t)=>{n(e,(e=>{const n=[...e.childNodes],o={};for(const t of e.attributes)o[[t.name]]=t.value;const i=s(t);return i(e,o,n),()=>{(e=>c.has(e))(i)&&(e=>{const t=c.get(e);t&&a.then((()=>{t.forEach((e=>{e.r(),e.r=null})),t.clear()}))})(i)}}))},Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));

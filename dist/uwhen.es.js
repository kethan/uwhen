var t=new Set;function e(e,n){var o=new Set;function c(){document.querySelectorAll(e).forEach((function(c){if(!o.has(c)){o.add(c);var r=n(c),i="function"==typeof r?r:function(){};!function(e,n,o){function c(){n&&document.contains(n)&&n.matches(e)||(t.delete(c),o())}setTimeout(c),t.add(c)}(e,c,(function(){o.delete(c),i()}))}}))}setTimeout(c),t.add(c)}new window.MutationObserver((function(){t.forEach((function(t){return t()}))})).observe(document,{attributes:!0,childList:!0,subtree:!0});var n="function"==typeof Promise?Promise:function(t){let e,n=[],o=0;return t((t=>{e=t,o=1,n.splice(0).forEach(c)})),{then:c};function c(t){return o?setTimeout(t,0,e):n.push(t),this}};const o=t=>{const{$:e,r:n,h:o}=t;u(n)&&(c.get(o).delete(t),n()),u(t.r=e())&&c.get(o).add(t)},c=new WeakMap,r=[],i=[],u=t=>"function"==typeof t,a=t=>{const e={h:n,c:null,a:null,e:0,i:0,s:[]};return n;function n(){e.e=e.i=0;try{return t.apply(e.c=this,e.a=arguments)}finally{r.length&&s.then(r.forEach.bind(r.splice(0),o)),i.length&&i.splice(0).forEach(o)}}},s=new n((t=>t())),f=(t,n)=>{e(t,(t=>{const e=[...t.childNodes],o={};for(const n of t.attributes)o[[n.name]]=n.value;const r=a(n);return r(t,o,e),()=>{(t=>c.has(t))(r)&&(t=>{const e=c.get(t);e&&s.then((()=>{e.forEach((t=>{t.r(),t.r=null})),e.clear()}))})(r)}}))};export{f as when};
